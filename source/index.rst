######################################################################
Usermin セットアップログ
######################################################################

| このドキュメントでは、Userminをインストール手順について記述してあります。
| なお、必要な機能はパスワード変更のみのため、「Change Password」のみ使用できるようにセットアップします。

======================================================================
インストール
======================================================================

----------------------------------------------------------------------
関連モジュールのインストール
----------------------------------------------------------------------

関連パッケージをインストールする。

.. code-block:: bash

    $ yum install perl-Net-SSLeay perl-Authen-PAM

----------------------------------------------------------------------
Userminのインストール
----------------------------------------------------------------------

Webminのダウンロードサイトから、UserminのRPMファイルのURLを確認する。

.. code-block:: text

    http://download.webmin.com/download/yum/

なお、本ドキュメントでは、次のバージョンのRPMファイルでインストールする場合を例に記述します。

* usermin-1.701-1.noarch.rpm

Userminをインストールする。

.. code-block:: bash

    $ yum install http://prdownloads.sourceforge.net/webadmin/usermin-1.710-1.noarch.rpm

======================================================================
設定
======================================================================

----------------------------------------------------------------------
接続を許可するネットワークの設定
----------------------------------------------------------------------

ここでは、次のネットワークを許可する場合を例に記述します。

* 127.0.0.1
* 192.168.179.*

/etc/usermin/miniserv.conf ファイルに次の設定を追加します。

.. code-block:: text

    allow=127.0.0.1 192.168.179.0/24

----------------------------------------------------------------------
root でのアクセスを禁止する設定
----------------------------------------------------------------------

/etc/usermin/miniserv.conf ファイルに次の設定を追加します。

.. code-block:: text

    denyusers=root

----------------------------------------------------------------------
デフォルト言語を日本語に設定
----------------------------------------------------------------------

/etc/usermin/config ファイルの **lang** パラメータを次のように変更します。

.. code-block:: text

    lang=ja_JP.UTF-8

----------------------------------------------------------------------
デフォルトテーマを *authentic-theme* に設定
----------------------------------------------------------------------

/etc/usermin/config ファイルの **theme** パラメータを次のように変更します。

.. code-block:: text

    theme=authentic-theme

/etc/usermin/miniserv.conf ファイルの **preroot** パラメータを次のように変更します。

.. code-block:: text

    preroot=authentic-theme

----------------------------------------------------------------------
Userminで使用する機能をパスワード変更のみに設定
----------------------------------------------------------------------

/etc/usermin/webmin.acl ファイルの **user** パラメータを次のように変更します。

.. code-block:: text

    user: changepass

----------------------------------------------------------------------
Userminサービス起動設定を確認
----------------------------------------------------------------------

Userminサービスの起動設定を確認します。

| **chkconfig** コマンドを実行し、使用するランレベルに **on** と表示されていれば起動設定されています。
| 以下の例では、ランレベル2、3、5で起動するように設定してあります。

.. code-block:: bash

    $ chkconfig --list usermin
    usermin        	0:off	1:off	2:on	3:on	4:off	5:on	6:off

----------------------------------------------------------------------
ファイアウォールの設定変更
----------------------------------------------------------------------

ファイアウォールでUserminが使用するポート（デフォルトでは20000）を許可します。

.. code-block:: bash

    $ firewall-cmd --add-port=20000/tcp --permanent


======================================================================
動作確認
======================================================================

| ブラウザからUserminにアクセスし、次のようにログイン画面が表示されれば正常に起動しています。
| 以下の例では、サーバのIPアドレスを192.168.179.10、ポート番号を20000としてあります。

.. image:: /images/usermin-1.png
